<!DOCTYPE html>
<html>
  <head>
    <style>
      #canvas {
        border: 1px solid black;
        width: 500px;
        height: 500px;
        position: relative;
      }
      #player {
        width: 50px;
        height: 50px;
        background-color: red;
        position: absolute;
        left: 0;
        top: 0;
      }
    </style>
    <script>
      var exports = {};
    </script>
    <script type="module" src="../lib/inputActions.js"></script>
  </head>
  <body>
    <div id="canvas">
      <div id="player"></div>
    </div>

    <script>
      const canvas = document.getElementById('canvas');
      const player = document.getElementById('player');
      const stepSize = 50;

      const defaultMapping = {
        directionY: [
          { type: 'keyboard', key: 'w', options: { event: 'repeat', value: 1 } },
          { type: 'keyboard', key: 's', otions: { event: 'repeat', value: -1 } },
          { type: 'gamepad', key: -2 },
        ],
        directionX: [
          { type: 'keyboard', key: 'd', options: { event: 'repeat', value: 1 } },
          { type: 'keyboard', key: 'a', otions: { event: 'repeat', value: 1 } },
          { type: 'gamepad', key: -1 },
        ],
        // rotation: [
        //   { type: 'keyboard', key: 'd', value: 1 },
        //   { type: 'keyboard', key: 'a', value: -1 },
        //   { type: 'gamepad', key: InputFusion.LeftJoystickAxeX },
        // ],
        // speed: [
        //   { type: 'keyboard', key: 'leftArrow', value: -1 },
        //   { type: 'keyboard', key: 'rightArrow', value: 1 },
        //   { type: 'gamepad', key: InputFusion.KeyPlus, value: 1 },
        //   { type: 'gamepad', key: InputFusion.KeyMinus, value: 1 },
        // ],
      };

      inputActions.defineInputActions(defaultMapping);

      inputActions.onInputActions(
        `cubeActionHandler`,
        {
          directionX: (v) => moveX(v),
          directionY: (v) => moveY(v),
        },
        () => setActive(false),
      );

      function moveY(direction) {
        let top = parseInt(window.getComputedStyle(player).getPropertyValue('top'));
        if (direction > 0) {
          if (top > 0) {
            player.style.top = `${top - stepSize}px`;
          }
        } else {
          if (top + stepSize < canvas.offsetHeight - player.offsetHeight) {
            player.style.top = `${top + stepSize}px`;
          }
        }
      }

      function moveX(direction) {
        let left = parseInt(window.getComputedStyle(player).getPropertyValue('left'));
        if (direction > 0) {
          if (left + stepSize < canvas.offsetWidth - player.offsetWidth) {
            player.style.left = `${left + stepSize}px`;
          }
        } else {
          if (left > 0) {
            player.style.left = `${left - stepSize}px`;
          }
        }
      }

      //   function moveUp() {
      //     let top = parseInt(window.getComputedStyle(player).getPropertyValue('top'));
      //     if (top > 0) {
      //       player.style.top = `${top - stepSize}px`;
      //     }
      //   }

      //   function moveDown() {
      //     let top = parseInt(window.getComputedStyle(player).getPropertyValue('top'));
      //     if (top + stepSize < canvas.offsetHeight - player.offsetHeight) {
      //       player.style.top = `${top + stepSize}px`;
      //     }
      //   }

      //   function moveLeft() {
      //     let left = parseInt(window.getComputedStyle(player).getPropertyValue('left'));
      //     if (left > 0) {
      //       player.style.left = `${left - stepSize}px`;
      //     }
      //   }

      //   function moveRight() {
      //     let left = parseInt(window.getComputedStyle(player).getPropertyValue('left'));
      //     if (left + stepSize < canvas.offsetWidth - player.offsetWidth) {
      //       player.style.left = `${left + stepSize}px`;
      //     }
      //   }
    </script>
  </body>
</html>
